# Glance - Mac AI Agent 产品需求文档 (PRD)

## 1. 产品概述

### 1.1 产品名称
Glance - 简单智能任务助手

### 1.2 产品定位
Glance 是一款轻量级的 Mac 桌面应用，通过简单的工作流帮助用户从 Backlog 读取工作票据，利用 AI 快速生成可执行的待办清单。无需复杂配置，开箱即用。

### 1.3 目标用户
- 使用 Backlog 的个人开发者
- 需要快速整理任务的项目成员
- 追求简单高效工具的用户

### 1.4 核心价值
- **简单**: 三步完成任务生成（配置 → 读取 → 生成）
- **快速**: 一键从 Backlog 获取票据并生成待办清单
- **纯本地**: 无需后端服务器，无需登录账号，数据存储在本地
- **隐私**: 所有配置和数据只存在你的 Mac 上

---

## 2. 简单工作流

### 2.1 核心流程（三步走）

```
步骤 1: 连接 Backlog
   ↓
步骤 2: 读取我的票据
   ↓
步骤 3: AI 生成 Todo List
   ↓
完成！查看和使用待办清单
```

### 2.2 功能需求

#### 2.2.1 步骤 1: 连接 Backlog
**功能描述**: 简单配置 Backlog 连接（仅配置 API，无需登录账号）

**需求**:
- 输入 Backlog Space ID（如：your-space）
- 输入 Backlog API Key（从 Backlog 网站获取）
- 输入 OpenAI API Key
- 点击"保存配置"
- 配置保存到本地，下次自动加载

**说明**:
- 无需创建账号或登录
- 只需要 Backlog 的 API Key（可以在 Backlog 个人设置中生成）
- 所有数据存储在本地 Mac 上

**界面**:
```
┌─────────────────────────────────┐
│  配置 API                       │
├─────────────────────────────────┤
│  Backlog Space ID:              │
│  [____________]                 │
│                                 │
│  Backlog API Key:               │
│  [____________]                 │
│                                 │
│  OpenAI API Key:                │
│  [____________]                 │
│                                 │
│         [保存配置]              │
└─────────────────────────────────┘
```

#### 2.2.2 步骤 2: 读取票据
**功能描述**: 一键读取分配给我的票据

**需求**:
- 点击"读取我的票据"按钮
- 使用配置的 API Key 自动获取票据（无需输入用户名密码）
- 显示票据列表：
  - 票据编号（如 PROJ-123）
  - 标题
  - 优先级
  - 截止日期
- 支持选择要处理的票据（默认全选）

**界面**:
```
┌─────────────────────────────────┐
│  我的 Backlog 票据 (3)          │
├─────────────────────────────────┤
│  ☑ [PROJ-123] 实现搜索功能      │
│     优先级: 高 | 截止: 01-05    │
│                                 │
│  ☑ [PROJ-124] 修复支付 Bug      │
│     优先级: 高 | 截止: 01-03    │
│                                 │
│  ☑ [PROJ-125] 优化页面性能      │
│     优先级: 中 | 截止: 01-10    │
│                                 │
│      [生成 Todo List]           │
└─────────────────────────────────┘
```

#### 2.2.3 步骤 3: AI 生成 Todo List
**功能描述**: AI 自动将票据转换为可执行的待办清单

**需求**:
- 点击"生成 Todo List"按钮
- AI 分析选中的票据，生成子任务
- 显示生成的待办清单
- 每个任务包含：
  - 任务标题
  - 预估时间
  - 优先级
  - 来源票据

**AI 处理逻辑**:
```
输入: Backlog 票据
AI 处理: 拆解为可执行的小任务
输出: 待办清单
```

**界面**:
```
┌─────────────────────────────────┐
│  ✨ AI 生成的待办清单           │
├─────────────────────────────────┤
│  来自 [PROJ-123] 实现搜索功能   │
│  ☐ 设计搜索框 UI (1.5h)         │
│  ☐ 实现搜索 API 对接 (3h)       │
│  ☐ 实现搜索结果展示 (2h)        │
│  ☐ 编写单元测试 (1.5h)          │
│                                 │
│  来自 [PROJ-124] 修复支付 Bug   │
│  ☐ 复现支付问题 (1h)            │
│  ☐ 定位 Bug 原因 (2h)           │
│  ☐ 修复并测试 (2h)              │
└─────────────────────────────────┘
```

### 2.3 基础功能

#### 2.3.1 任务管理
- ✅ 点击任务前的复选框标记完成
- 📝 双击任务可编辑内容
- 🗑️ 右键删除任务
- 📋 复制任务内容

#### 2.3.2 配置管理
- 保存 Backlog 配置（本地）
- 保存 AI API Key（安全存储）
- 下次打开自动加载配置

---

## 3. 用户体验设计

### 3.1 简化的使用流程

#### 首次使用（仅一次，2 分钟）
```
1. 打开应用
   ↓
2. 输入 Backlog API 配置
   - Space ID
   - API Key（从 Backlog 网站获取）
   ↓
3. 输入 OpenAI API Key
   ↓
4. 保存配置
   ↓
完成！无需登录账号
```

#### 日常使用（每次 30 秒）
```
1. 打开应用
   ↓
2. 点击"读取我的票据"
   ↓
3. 选择要处理的票据（默认全选）
   ↓
4. 点击"生成 Todo List"
   ↓
5. 查看待办清单，开始工作！
```

### 3.2 主界面设计

```
┌─────────────────────────────────────────┐
│  Glance                      [⚙️ 设置]  │
├─────────────────────────────────────────┤
│                                         │
│  第一步: 读取 Backlog 票据              │
│  ┌───────────────────────────────────┐ │
│  │                                   │ │
│  │     [📥 读取我的票据]             │ │
│  │                                   │ │
│  └───────────────────────────────────┘ │
│                                         │
│  第二步: 选择要处理的票据              │
│  ┌───────────────────────────────────┐ │
│  │ ☑ [PROJ-123] 实现登录功能         │ │
│  │ ☑ [PROJ-124] 修复支付 Bug         │ │
│  │ ☑ [PROJ-125] 优化页面性能         │ │
│  └───────────────────────────────────┘ │
│                                         │
│  第三步: 生成待办清单                  │
│  ┌───────────────────────────────────┐ │
│  │                                   │ │
│  │     [✨ 生成 Todo List]           │ │
│  │                                   │ │
│  └───────────────────────────────────┘ │
│                                         │
│  ✅ 我的待办清单                       │
│  ┌───────────────────────────────────┐ │
│  │ ☐ 设计搜索框 UI (1.5h)            │ │
│  │ ☐ 实现搜索 API 对接 (3h)          │ │
│  │ ☐ 实现搜索结果展示 (2h)           │ │
│  │ ☐ 复现支付问题 (1h)               │ │
│  │ ...                               │ │
│  └───────────────────────────────────┘ │
│                                         │
└─────────────────────────────────────────┘
```

### 3.3 设计原则
- **极简**: 只保留核心功能，去除复杂选项
- **清晰**: 三步流程一目了然
- **快速**: 从打开到生成清单不超过 30 秒

---

## 4. 技术方案（简化版）

### 4.1 技术选型

**前端**:
- Swift + SwiftUI（Mac 原生应用）
- 单窗口应用，无需复杂导航

**API 集成**:
- Backlog REST API（读取票据）
- OpenAI API（GPT-4 生成待办清单）

**数据存储**:
- UserDefaults（保存配置）
- Keychain（安全存储 API Key）
- 无需数据库（不保存历史记录）

### 4.2 简化架构

```
┌─────────────────────────────────┐
│      SwiftUI 界面               │
│   (单个主窗口)                  │
└────────────┬────────────────────┘
             │
┌────────────▼────────────────────┐
│    核心逻辑                     │
│  - BacklogService (读取票据)   │
│  - AIService (生成待办清单)    │
└────────────┬────────────────────┘
             │
┌────────────▼────────────────────┐
│    本地存储                     │
│  - UserDefaults (配置)         │
│  - Keychain (密钥)             │
└─────────────────────────────────┘
```

### 4.3 核心代码结构

```
Glance/
├── GlanceApp.swift          # 应用入口
├── Views/
│   ├── MainView.swift       # 主界面
│   └── SettingsView.swift   # 设置界面
├── Services/
│   ├── BacklogService.swift # Backlog API 调用
│   └── AIService.swift      # OpenAI API 调用
├── Models/
│   ├── BacklogIssue.swift   # 票据模型
│   └── TodoItem.swift       # 待办事项模型
└── Utils/
    └── KeychainHelper.swift # 密钥存储
```

### 4.4 数据模型（简化版）

```swift
// Backlog 票据
struct BacklogIssue: Identifiable {
    let id: Int
    let key: String        // PROJ-123
    let summary: String    // 标题
    let description: String
    let priority: String   // "高", "中", "低"
    let dueDate: String?   // "2025-01-05"
}

// 待办事项
struct TodoItem: Identifiable {
    let id = UUID()
    var title: String
    var estimatedTime: String?  // "2h"
    var isCompleted: Bool = false
    let sourceIssueKey: String  // PROJ-123
}
```

---

## 5. 开发计划

### 5.1 MVP 功能（1 周完成）

**核心功能**:
- ✅ Backlog API 集成（读取我的票据）
- ✅ OpenAI API 集成（生成待办清单）
- ✅ 简单的 UI 界面（三步流程）
- ✅ 配置管理（保存和加载）
- ✅ 基础任务管理（标记完成、编辑、删除）

**开发任务**:
1. Day 1-2: 搭建 SwiftUI 项目框架
2. Day 3-4: 实现 Backlog API 调用
3. Day 5: 实现 OpenAI API 调用
4. Day 6: 完成 UI 界面
5. Day 7: 测试和优化

### 5.2 可选增强功能（如有时间）
- 深色模式支持
- 任务编辑功能
- 更美观的 UI 设计
- 错误处理优化

### 5.3 不做的功能（保持简单）
- ❌ 数据导出功能
- ❌ 复杂的筛选和搜索
- ❌ 自动同步和通知
- ❌ 历史记录保存
- ❌ 任务统计分析
- ❌ 团队协作功能

---

## 6. 基本要求

### 6.1 性能要求
- 应用启动快速（< 2 秒）
- API 调用有加载提示
- 界面操作流畅

### 6.2 安全要求
- API Key 使用 Keychain 存储
- 数据传输使用 HTTPS

### 6.3 兼容性要求
- 支持 macOS 13.0 及以上
- 支持 Apple Silicon 和 Intel 芯片

---

## 7. 使用示例

### 7.1 AI 生成示例

**输入（Backlog 票据）**:
```
[PROJ-123] 实现商品搜索功能
描述: 需要实现商品搜索功能，包括搜索框UI、搜索API对接和结果展示
优先级: 高
截止日期: 2025-01-05
```

**输出（AI 生成的 Todo List）**:
```
✨ 来自 [PROJ-123] 实现商品搜索功能

☐ 设计搜索框 UI (1.5h)
  - 设计搜索输入框和按钮
  - 添加搜索历史记录
  - 设计自动补全样式

☐ 实现搜索 API 对接 (3h)
  - 调用后端搜索接口
  - 实现防抖优化
  - 处理错误情况

☐ 实现搜索结果展示 (2h)
  - 设计结果列表 UI
  - 实现分页加载
  - 添加空状态提示

☐ 编写单元测试 (1.5h)
  - 测试搜索功能
  - 测试边界情况
  - 测试性能
```

---

## 8. 附录

### 8.1 参考资料
- [Backlog API 文档](https://developer.nulab.com/docs/backlog/)
- [OpenAI API 文档](https://platform.openai.com/docs/)

### 8.2 术语表
- **Backlog**: 项目管理工具
- **Todo List**: 待办事项清单
- **API Key**: 用于身份验证的密钥

---

## 9. 版本历史

| 版本 | 日期 | 变更说明 |
|------|------|----------|
| 1.0 | 2025-12-30 | 初始版本 |
| 1.1 | 2025-12-30 | 简化为无后端版本 |

---

**文档状态**: ✅ 已完成  
**产品定位**: 简单、快速、无后端的 Mac 桌面工具  
**开发周期**: 1 周 MVP  
**下一步**: 开始开发

